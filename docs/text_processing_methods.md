# テキストの処理方法

data/input.txt のテキストを以下の手順で処理する。

1. テキストの行分割とトリム
2. 単語エントリの抽出
3. 説明文の処理

それぞれの手順について以下に詳細を記述する。

## 1. テキストの行分割とトリム

以下の手順に従って、テキスト全体の単一の文字列から、文字列の配列に変換する。

1. テキストを行に分割する
2. 各行の前後の空白を削除する
3. 空白行を削除する

## 2. 単語エントリの抽出

次に、各行を集計して、以下の単語エントリのデータを抽出する。
単語エントリの型は以下のとおり。

```ts
interface WordEntry {
  number: string;
  name: string;
  descriptionLines: string;
}
```

単語エントリは以下の手順で抽出する。

1. 単語番号の行を検出する

- 単語番号はの形式は小数値である
- "3.x" の形式で、行頭に数字 "3" があり、その後に小数点と数字が続く
- 例： "3.1", "3.2", "3.3" など

2. 単語名の行を検出する

- 単語名は単語番号の次の行である
- この行は必ず存在する

3. 説明文の行を検出する

- 単語名の次の行から、次の単語番号の行までの間の全ての行
- 説明文は複数行にまたがることがある
- 説明文の複数行の処理は後続処理で行うため、ここでは単純に配列に追加する

## 3. 説明文の処理

次に、単語エントリごとの説明文の処理を行う。
前の処理で複数行の文字列として抽出された説明文を処理して、以下のスキーマに変換する。

```ts
interface WordDescription {
  definition: string;
  alias?: string;
  confer?: string;
  example?: string;
  note?: string;
}
```

説明文の行は以下のパターンがある。これらを場合分けして処理する。

1. 特別なプレフィックスを持つ行

- "1. ", "cf. ", "EXAMPLE: ", "Note 1 to entry: " で開始する行は、特別な行として扱う
- これらが見つかった場合は、新規のセクションが開始したものとして扱う
- これらは以下の専用フィールドに保存する。
  - "1. " は "definition" フィールドに保存
  - "cf. " は "confer" フィールドに保存
  - "EXAMPLE: " は "example" フィールドに保存
  - "Note 1 to entry: " は "note" フィールドに保存

2. Alias の行

- 最初の特別なプレフィックスが見つかるまでの間にある行は、Alias の行である
- 単語エントリによっては存在しないものがある
- 複数行存在する場合もある。複数行の場合は、スペースで結合する
- Alias は "alias" フィールドに保存する

3. その他の行

- 上記以外の行は、文章の途中ものとして扱う。これらは、前の行とスペースで結合する
